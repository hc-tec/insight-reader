# ç¤ºä¾‹æ–‡ç« åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“– åŠŸèƒ½æ¦‚è¿°

ç¤ºä¾‹æ–‡ç« ç³»ç»Ÿå…è®¸ç®¡ç†å‘˜æ ‡è®°ç‰¹å®šæ–‡ç« ä½œä¸ºå…¬å¼€ç¤ºä¾‹ï¼Œ**ä»»ä½•äººï¼ˆåŒ…æ‹¬æœªç™»å½•ç”¨æˆ·ï¼‰éƒ½å¯ä»¥æŸ¥çœ‹è¿™äº›ç¤ºä¾‹æ–‡ç« å’Œå®Œæ•´çš„AIåˆ†æç»“æœ**ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

1. **å…¬å¼€è®¿é—®** - æ— éœ€ç™»å½•å³å¯æŸ¥çœ‹
2. **å®Œæ•´åˆ†æ** - å±•ç¤º Sparksã€æ·±åº¦æ´å¯Ÿã€å…ƒè§†è§’ç­‰æ‰€æœ‰åˆ†æ
3. **å¼•å¯¼æ³¨å†Œ** - é€šè¿‡ä¼˜è´¨ç¤ºä¾‹å¸å¼•ç”¨æˆ·æ³¨å†Œ
4. **æ˜“äºç®¡ç†** - ç®¡ç†å‘˜å¯è½»æ¾æ·»åŠ /åˆ é™¤ç¤ºä¾‹

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: æ•°æ®åº“è¿ç§»

é¦–æ¬¡ä½¿ç”¨éœ€è¦æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼š

\`\`\`bash
cd backend
python -m app.db.migrate_add_demo_fields
\`\`\`

è¿™ä¼šæ·»åŠ ä»¥ä¸‹å­—æ®µï¼š
- `is_demo` (BOOLEAN) - æ ‡è®°æ˜¯å¦ä¸ºç¤ºä¾‹æ–‡ç« 
- `demo_order` (INTEGER) - æ§åˆ¶å±•ç¤ºé¡ºåº

**å›æ»šè¿ç§»**ï¼ˆå¦‚éœ€è¦ï¼‰ï¼š
\`\`\`bash
python -m app.db.migrate_add_demo_fields rollback
\`\`\`

### æ­¥éª¤2: æ ‡è®°ç¤ºä¾‹æ–‡ç« 

ä½¿ç”¨ç®¡ç†å‘˜ API æ ‡è®°æ–‡ç« ä¸ºç¤ºä¾‹ï¼š

\`\`\`http
POST /api/v1/admin/demo/articles/{article_id}/mark
Authorization: Bearer <admin_jwt_token>
Content-Type: application/json

{
  "demo_order": 1,
  "pregenerate_analysis": true
}
\`\`\`

**å‚æ•°è¯´æ˜ï¼š**
- `demo_order`: å±•ç¤ºé¡ºåºï¼ˆå¯é€‰ï¼Œæ•°å­—è¶Šå°è¶Šé å‰ï¼‰
- `pregenerate_analysis`: æ˜¯å¦ç«‹å³é¢„ç”Ÿæˆæ‰€æœ‰åˆ†æï¼ˆæ¨è `true`ï¼‰

### æ­¥éª¤3: è®¿é—®ç¤ºä¾‹

è®¿é—®ä»¥ä¸‹é¡µé¢æŸ¥çœ‹ç¤ºä¾‹ï¼š
- **åˆ—è¡¨é¡µ**: `http://localhost:3000/demo`
- **è¯¦æƒ…é¡µ**: `http://localhost:3000/demo/{article_id}`

---

## ğŸ” ç®¡ç†å‘˜æƒé™é…ç½®

### è®¾ç½®ç®¡ç†å‘˜

ç¼–è¾‘ `backend/app/api/admin_demo.py`ï¼š

\`\`\`python
# ç¬¬ 38 è¡Œé™„è¿‘
ADMIN_EMAILS = [
    "admin@insightreader.com",
    "your-email@example.com",  # æ·»åŠ ä½ çš„é‚®ç®±
]
\`\`\`

**âš ï¸ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µï¼š**
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ç®¡ç†å‘˜åˆ—è¡¨
- æˆ–ä½¿ç”¨æ•°æ®åº“ `users` è¡¨æ·»åŠ  `is_admin` å­—æ®µ

---

## ğŸ“¡ API ç«¯ç‚¹æ–‡æ¡£

### å…¬å¼€APIï¼ˆæ— éœ€è®¤è¯ï¼‰

#### 1. è·å–ç¤ºä¾‹æ–‡ç« åˆ—è¡¨
\`\`\`http
GET /api/v1/public/demo/articles?limit=10&offset=0
\`\`\`

**å“åº”ï¼š**
\`\`\`json
{
  "total": 5,
  "articles": [
    {
      "id": 1,
      "title": "AIå¦‚ä½•æ”¹å˜ä¸–ç•Œ",
      "author": "å¼ ä¸‰",
      "word_count": 3500,
      "demo_order": 1,
      "has_analysis": true,
      "has_meta_analysis": true,
      "insight_count": 12
    }
  ]
}
\`\`\`

#### 2. è·å–ç¤ºä¾‹æ–‡ç« è¯¦æƒ…
\`\`\`http
GET /api/v1/public/demo/articles/{article_id}
\`\`\`

**å“åº”ï¼š**
\`\`\`json
{
  "id": 1,
  "title": "...",
  "content": "...",
  "analysis_report": {
    "sparks": [...],
    "deep_insights": [...],
    "follow_up_questions": [...]
  },
  "meta_analysis": {
    "meta_insights": [...]
  }
}
\`\`\`

#### 3. è·å– Sparks
\`\`\`http
GET /api/v1/public/demo/articles/{article_id}/sparks
\`\`\`

#### 4. è·å–æ·±åº¦æ´å¯Ÿ
\`\`\`http
GET /api/v1/public/demo/articles/{article_id}/insights
\`\`\`

#### 5. è·å–å…ƒè§†è§’åˆ†æ
\`\`\`http
GET /api/v1/public/demo/articles/{article_id}/meta
\`\`\`

---

### ç®¡ç†å‘˜APIï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰

#### 1. æ ‡è®°ä¸ºç¤ºä¾‹
\`\`\`http
POST /api/v1/admin/demo/articles/{article_id}/mark
Authorization: Bearer <token>

{
  "demo_order": 1,
  "pregenerate_analysis": true
}
\`\`\`

#### 2. å–æ¶ˆç¤ºä¾‹æ ‡è®°
\`\`\`http
DELETE /api/v1/admin/demo/articles/{article_id}/unmark
Authorization: Bearer <token>
\`\`\`

#### 3. æ›´æ–°å±•ç¤ºé¡ºåº
\`\`\`http
PUT /api/v1/admin/demo/articles/{article_id}/order?order=2
Authorization: Bearer <token>
\`\`\`

#### 4. é¢„ç”Ÿæˆåˆ†æ
\`\`\`http
POST /api/v1/admin/demo/articles/{article_id}/pregenerate?force_regenerate=false
Authorization: Bearer <token>
\`\`\`

**å“åº”ï¼š**
\`\`\`json
{
  "task_id": "abc-123",
  "article_id": 1,
  "status": "processing",
  "message": "é¢„ç”Ÿæˆä»»åŠ¡å·²æäº¤..."
}
\`\`\`

#### 5. æŸ¥çœ‹æ‰€æœ‰ç¤ºä¾‹æ–‡ç« ï¼ˆç®¡ç†å‘˜è§†å›¾ï¼‰
\`\`\`http
GET /api/v1/admin/demo/articles
Authorization: Bearer <token>
\`\`\`

---

## ğŸ¨ å‰ç«¯é¡µé¢

### 1. ç¤ºä¾‹æ–‡ç« åˆ—è¡¨é¡µ
**è·¯å¾„**: `/demo`
**ç»„ä»¶**: `pages/demo/index.vue`

**ç‰¹æ€§ï¼š**
- å±•ç¤ºæ‰€æœ‰ç¤ºä¾‹æ–‡ç« å¡ç‰‡
- æ˜¾ç¤ºæ–‡ç« ç»Ÿè®¡ä¿¡æ¯ï¼ˆå­—æ•°ã€æ´å¯Ÿæ•°ç­‰ï¼‰
- å¼•å¯¼æœªç™»å½•ç”¨æˆ·æ³¨å†Œ
- å“åº”å¼è®¾è®¡

### 2. ç¤ºä¾‹æ–‡ç« è¯¦æƒ…é¡µ
**è·¯å¾„**: `/demo/:id`
**ç»„ä»¶**: `pages/demo/[id].vue`

**ç‰¹æ€§ï¼š**
- å®Œæ•´å±•ç¤ºæ–‡ç« å†…å®¹
- AIåˆ†æç»“æœï¼ˆSparksã€æ·±åº¦æ´å¯Ÿã€è¿½é—®ï¼‰
- å…ƒè§†è§’åˆ†æ
- ç¤ºä¾‹æ ‡è¯†æ¡
- åº•éƒ¨æ³¨å†Œå¼•å¯¼

### 3. é¦–é¡µå…¥å£
**ç»„ä»¶**: `components/ArticleInput.vue`

åœ¨"å¿«é€Ÿå¼€å§‹"åŒºåŸŸæ·»åŠ äº†é†’ç›®çš„**"æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹æ–‡ç« "**æŒ‰é’®ã€‚

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°ç»†èŠ‚

### åç«¯æ¶æ„

\`\`\`
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ models/models.py              # Article æ¨¡å‹ï¼ˆæ–°å¢å­—æ®µï¼‰
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ public_demo.py           # å…¬å¼€APIï¼ˆæ— éœ€è®¤è¯ï¼‰
â”‚   â”‚   â””â”€â”€ admin_demo.py            # ç®¡ç†å‘˜API
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ demo_pregeneration_service.py  # é¢„ç”ŸæˆæœåŠ¡
â”‚   â””â”€â”€ db/
â”‚       â””â”€â”€ migrate_add_demo_fields.py  # æ•°æ®åº“è¿ç§»
\`\`\`

### å‰ç«¯æ¶æ„

\`\`\`
frontend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â””â”€â”€ demo/
â”‚   â”‚       â”œâ”€â”€ index.vue            # åˆ—è¡¨é¡µ
â”‚   â”‚       â””â”€â”€ [id].vue             # è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â””â”€â”€ useDemoArticles.ts      # API è°ƒç”¨å°è£…
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ ArticleInput.vue         # æ·»åŠ å…¥å£æŒ‰é’®
\`\`\`

### æœ€ä½³å®è·µ

#### 1. æ•°æ®åº“è®¾è®¡
- âœ… ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- âœ… ä½¿ç”¨ç»„åˆç´¢å¼•ï¼ˆis_demo + demo_orderï¼‰
- âœ… ä½¿ç”¨éƒ¨åˆ†ç´¢å¼•ï¼ˆWHERE is_demo = TRUEï¼‰

#### 2. APIè®¾è®¡
- âœ… å…¬å¼€APIä¸è®¤è¯APIåˆ†ç¦»
- âœ… ä½¿ç”¨ Pydantic æ¨¡å‹éªŒè¯å“åº”
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†
- âœ… ä½¿ç”¨ joinedload é¿å… N+1 æŸ¥è¯¢

#### 3. æ€§èƒ½ä¼˜åŒ–
- âœ… é¢„ç”Ÿæˆæ‰€æœ‰åˆ†æï¼ˆé¿å…å®æ—¶è®¡ç®—ï¼‰
- âœ… ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡ï¼ˆTaskManagerï¼‰
- âœ… å¯é€‰ï¼šæ·»åŠ  Redis ç¼“å­˜å±‚

#### 4. å®‰å…¨æ€§
- âœ… éªŒè¯æ–‡ç« å¿…é¡»æ˜¯ç¤ºä¾‹æ–‡ç« 
- âœ… ç®¡ç†å‘˜æƒé™æ£€æŸ¥
- âœ… è¯¦ç»†çš„æ“ä½œæ—¥å¿—

---

## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹æµç¨‹

### ç®¡ç†å‘˜æ·»åŠ ç¤ºä¾‹æ–‡ç« 

1. **ä¸Šä¼ æ–‡ç« ** - æ­£å¸¸ä¸Šä¼ ä¸€ç¯‡æ–‡ç« åˆ°ç³»ç»Ÿ
2. **è·å–æ–‡ç« ID** - è®°å½•æ–‡ç« IDï¼ˆå¦‚ `123`ï¼‰
3. **æ ‡è®°ä¸ºç¤ºä¾‹**:
   \`\`\`bash
   curl -X POST "http://localhost:8000/api/v1/admin/demo/articles/123/mark" \\
     -H "Authorization: Bearer <token>" \\
     -H "Content-Type: application/json" \\
     -d '{
       "demo_order": 1,
       "pregenerate_analysis": true
     }'
   \`\`\`
4. **ç­‰å¾…é¢„ç”Ÿæˆå®Œæˆ** - åå°ä»»åŠ¡ä¼šè‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰åˆ†æ
5. **éªŒè¯** - è®¿é—® `http://localhost:3000/demo` æŸ¥çœ‹

### ç”¨æˆ·è®¿é—®ç¤ºä¾‹

1. **è®¿é—®é¦–é¡µ** - `http://localhost:3000/`
2. **ç‚¹å‡»**"æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹æ–‡ç« "æŒ‰é’®
3. **æµè§ˆåˆ—è¡¨** - æŸ¥çœ‹æ‰€æœ‰ç¤ºä¾‹æ–‡ç« 
4. **ç‚¹å‡»æ–‡ç« ** - æŸ¥çœ‹å®Œæ•´å†…å®¹å’ŒAIåˆ†æ
5. **æ³¨å†Œ** - è¢«ä¼˜è´¨ç¤ºä¾‹å¸å¼•ï¼Œç‚¹å‡»æ³¨å†Œ

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: ç¤ºä¾‹æ–‡ç« åˆ—è¡¨ä¸ºç©ºï¼Ÿ
**A:** ç¡®ä¿å·²æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼Œå¹¶ä¸”è‡³å°‘æ ‡è®°äº†ä¸€ç¯‡æ–‡ç« ä¸ºç¤ºä¾‹ã€‚

### Q2: é¢„ç”Ÿæˆåˆ†æå¤±è´¥ï¼Ÿ
**A:** æ£€æŸ¥åç«¯æ—¥å¿—ï¼Œç¡®ä¿ï¼š
- OpenAI API é…ç½®æ­£ç¡®
- æ–‡ç« å†…å®¹ä¸ä¸ºç©º
- åå°ä»»åŠ¡æ­£å¸¸è¿è¡Œ

### Q3: éç®¡ç†å‘˜å¦‚ä½•æ ‡è®°ç¤ºä¾‹ï¼Ÿ
**A:** åªæœ‰ç®¡ç†å‘˜é‚®ç®±æ‰èƒ½ä½¿ç”¨ç®¡ç†å‘˜APIã€‚è¯·è”ç³»ç®¡ç†å‘˜æˆ–ä¿®æ”¹ä»£ç ä¸­çš„ `ADMIN_EMAILS` åˆ—è¡¨ã€‚

### Q4: å¦‚ä½•å–æ¶ˆç¤ºä¾‹æ ‡è®°ï¼Ÿ
**A:**
\`\`\`bash
curl -X DELETE "http://localhost:8000/api/v1/admin/demo/articles/123/unmark" \\
  -H "Authorization: Bearer <token>"
\`\`\`

### Q5: ç¤ºä¾‹æ–‡ç« ä¼šè¢«åˆ é™¤å—ï¼Ÿ
**A:** ä¸ä¼šã€‚å–æ¶ˆç¤ºä¾‹æ ‡è®°åªæ˜¯å°† `is_demo` è®¾ä¸º `FALSE`ï¼Œæ–‡ç« æœ¬èº«ä¸ä¼šè¢«åˆ é™¤ï¼Œåˆ†æç»“æœä¹Ÿä¼šä¿ç•™ã€‚

---

## ğŸ“ˆ åç»­ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜å±‚** - æ·»åŠ  Redis ç¼“å­˜ç¤ºä¾‹æ–‡ç« æ•°æ®
2. **è®¿é—®ç»Ÿè®¡** - è®°å½•ç¤ºä¾‹æ–‡ç« è®¿é—®é‡ï¼Œå¸®åŠ©ä¼˜åŒ–ç¤ºä¾‹é€‰æ‹©
3. **ç®¡ç†ç•Œé¢** - å¼€å‘å¯è§†åŒ–çš„ç®¡ç†åå°
4. **è‡ªåŠ¨åˆ·æ–°** - å®šæœŸè‡ªåŠ¨æ›´æ–°ç¤ºä¾‹æ–‡ç« çš„åˆ†æç»“æœ
5. **å¤šè¯­è¨€** - æ”¯æŒä¸åŒè¯­è¨€çš„ç¤ºä¾‹æ–‡ç« 
6. **åˆ†ç±»æ ‡ç­¾** - ä¸ºç¤ºä¾‹æ–‡ç« æ·»åŠ åˆ†ç±»ï¼ˆç§‘æŠ€ã€è´¢ç»ã€æ–‡åŒ–ç­‰ï¼‰

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-10-23)
- âœ… å®ç°å…¬å¼€ç¤ºä¾‹æ–‡ç« ç³»ç»Ÿ
- âœ… æ·»åŠ ç®¡ç†å‘˜API
- âœ… æ·»åŠ é¢„ç”ŸæˆæœåŠ¡
- âœ… å®Œæˆå‰ç«¯é¡µé¢ï¼ˆåˆ—è¡¨ + è¯¦æƒ…ï¼‰
- âœ… æ·»åŠ é¦–é¡µå…¥å£

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- **åç«¯æ—¥å¿—**: æŸ¥çœ‹ `backend/` ç›®å½•ä¸‹çš„è¿è¡Œæ—¥å¿—
- **å‰ç«¯æ§åˆ¶å°**: æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹é”™è¯¯
- **API æ–‡æ¡£**: è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹ Swagger æ–‡æ¡£
