# å…ƒè§†è§’æ¨¡å¼ (Meta-View Mode) - æŠ€æœ¯è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| åŠŸèƒ½åç§° | å…ƒè§†è§’æ¨¡å¼ (Meta-View Mode) |
| ç‰ˆæœ¬ | v1.0.0 |
| æ–‡æ¡£çŠ¶æ€ | è®¾è®¡é˜¶æ®µ |
| åˆ›å»ºæ—¥æœŸ | 2025-10-20 |
| ä½œè€… | InsightReader Team |

---

## ğŸ¯ ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 åŠŸèƒ½æ„¿æ™¯

"å…ƒè§†è§’"æ—¨åœ¨æˆä¸º InsightReader çš„çµé­‚ï¼Œå°†é˜…è¯»ä»çº¿æ€§çš„ã€è¢«åŠ¨çš„ä¿¡æ¯æ¥æ”¶è¡Œä¸ºï¼Œè½¬å˜ä¸º**ç«‹ä½“çš„ã€å¤šç»´åº¦çš„ã€ä¸»åŠ¨çš„æ¢ç´¢ä¸å®¡è§†è¿‡ç¨‹**ã€‚æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯ç»™ç”¨æˆ·æä¾›ç­”æ¡ˆï¼Œè€Œæ˜¯èµ‹äºˆä»–ä»¬æå‡ºæ›´æ·±åˆ»é—®é¢˜çš„èƒ½åŠ›ã€‚

### 1.2 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

#### ç”¨æˆ·ä»·å€¼
- **æå‡æ‰¹åˆ¤æ€§æ€ç»´**: è¯†åˆ«è®ºè¯ç»“æ„ã€æƒ…æ„Ÿç«‹åœºå’Œæ½œåœ¨åè§
- **åŠ é€Ÿæ·±åº¦ç†è§£**: è§£æ„æ–‡ç« å…ƒä¿¡æ¯ï¼ˆæ„å›¾ã€èƒŒæ™¯ã€æ—¶æ•ˆï¼‰
- **èµ‹èƒ½å¹³è¡Œæ€ç»´**: å¤šç»´åº¦"æ€ç»´é€é•œ"ï¼Œä¸°å¯Œé˜…è¯»æ·±åº¦å’Œå¹¿åº¦

#### äº§å“ä»·å€¼
- å·®å¼‚åŒ–ç«äº‰ä¼˜åŠ¿ï¼Œå»ºç«‹æŠ€æœ¯å£å’
- æå‡ç”¨æˆ·ç²˜æ€§å’Œç•™å­˜ç‡
- æ”¶é›†é«˜è´¨é‡çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®

### 1.3 è®¾è®¡å“²å­¦

**"æŒ‰éœ€èµ‹èƒ½ï¼Œä¼˜é›…æ— æ‰°" (On-demand Empowerment, Elegant & Unobtrusive)**

- **éä¾µå…¥æ€§**: é»˜è®¤ä¸å¹²æ‰°é˜…è¯»æµï¼Œéœ€è¦æ—¶æ‰æ¿€æ´»
- **æ¸è¿›å¼æŠ«éœ²**: ä¿¡æ¯åˆ†å±‚å±•ç¤ºï¼Œé¿å…è®¤çŸ¥è¿‡è½½
- **å³æ—¶åé¦ˆ**: æ‰€æœ‰äº¤äº’æä¾›æ¸…æ™°çš„è§†è§‰åé¦ˆ
- **ç¾å­¦ä¸€è‡´**: å»¶ç»­æ·±é‚ƒã€å†¥æƒ³çš„è®¾è®¡é£æ ¼

---

## ğŸ—ï¸ äºŒã€åŠŸèƒ½æ¶æ„

### 2.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯ (Frontend)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é˜…è¯»é¡µé¢                                                â”‚
â”‚  â”œâ”€ ğŸ‘“ å…ƒè§†è§’è§¦å‘å™¨ (å›ºå®šåœ¨å³ä¸‹è§’/å³ä¸Šè§’)                â”‚
â”‚  â”œâ”€ ğŸ“„ æ–‡ç« å†…å®¹åŒº (å¯ç¼©æ”¾å®½åº¦)                           â”‚
â”‚  â””â”€ ğŸ“Š å…ƒä¿¡æ¯é¢æ¿ (æ»‘å‡ºå¼ä¾§è¾¹æ )                         â”‚
â”‚      â”œâ”€ å…ƒä¿¡æ¯å¡ç‰‡ (Meta-Info Cards)                     â”‚
â”‚      â”‚   â”œâ”€ ä½œè€…æ„å›¾åˆ†æ                                 â”‚
â”‚      â”‚   â”œâ”€ æ—¶æ•ˆæ€§è¯„ä¼°                                   â”‚
â”‚      â”‚   â”œâ”€ æ½œåœ¨åè§æ£€æµ‹                                 â”‚
â”‚      â”‚   â””â”€ çŸ¥è¯†ç¼ºå£æç¤º                                 â”‚
â”‚      â””â”€ æ€ç»´é€é•œåˆ‡æ¢å™¨ (Lens Switcher)                   â”‚
â”‚          â”œâ”€ è®ºè¯ç»“æ„é€é•œ                                 â”‚
â”‚          â””â”€ ä½œè€…ç«‹åœºé€é•œ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  çŠ¶æ€ç®¡ç† (Composables)                                  â”‚
â”‚  â”œâ”€ useMetaView.ts - å…ƒè§†è§’æ ¸å¿ƒé€»è¾‘                      â”‚
â”‚  â””â”€ useThinkingLens.ts - æ€ç»´é€é•œç®¡ç†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åç«¯ (Backend)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API è·¯ç”±                                                â”‚
â”‚  â”œâ”€ POST /api/v1/meta-analysis/analyze                  â”‚
â”‚  â”œâ”€ GET  /api/v1/meta-analysis/{article_id}             â”‚
â”‚  â”œâ”€ POST /api/v1/meta-analysis/feedback                 â”‚
â”‚  â””â”€ POST /api/v1/thinking-lens/apply                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœåŠ¡å±‚                                                  â”‚
â”‚  â”œâ”€ meta_analysis_service.py                            â”‚
â”‚  â”‚   â”œâ”€ analyze_article_meta_info()                     â”‚
â”‚  â”‚   â”œâ”€ detect_author_intent()                          â”‚
â”‚  â”‚   â”œâ”€ evaluate_timeliness()                           â”‚
â”‚  â”‚   â”œâ”€ detect_bias()                                   â”‚
â”‚  â”‚   â””â”€ identify_knowledge_gaps()                       â”‚
â”‚  â””â”€ thinking_lens_service.py                            â”‚
â”‚      â”œâ”€ apply_argument_lens()                           â”‚
â”‚      â””â”€ apply_stance_lens()                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LLM é›†æˆ (OpenAI API)                                   â”‚
â”‚  â”œâ”€ Prompt å·¥ç¨‹ (å¤šè½®å¯¹è¯ + CoT)                         â”‚
â”‚  â”œâ”€ JSON æ¨¡å¼å¼ºåˆ¶è¾“å‡º                                    â”‚
â”‚  â””â”€ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åº“ (Database)                                       â”‚
â”‚  â”œâ”€ meta_analyses - å…ƒä¿¡æ¯åˆ†æè¡¨                        â”‚
â”‚  â”œâ”€ thinking_lens_results - é€é•œåˆ†æç»“æœè¡¨              â”‚
â”‚  â””â”€ meta_view_feedback - ç”¨æˆ·åé¦ˆè¡¨                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ¨¡å—åˆ’åˆ†

#### å‰ç«¯æ¨¡å—
1. **MetaViewTrigger** - è§¦å‘å™¨ç»„ä»¶
2. **MetaInfoPanel** - å…ƒä¿¡æ¯é¢æ¿
3. **MetaInfoCard** - å…ƒä¿¡æ¯å¡ç‰‡ï¼ˆå¯å¤ç”¨ï¼‰
4. **ThinkingLensSwitcher** - é€é•œåˆ‡æ¢å™¨
5. **ArticleHighlighter** - æ–‡ç« é«˜äº®æ¸²æŸ“å™¨

#### åç«¯æ¨¡å—
1. **MetaAnalysisService** - å…ƒä¿¡æ¯åˆ†ææœåŠ¡
2. **ThinkingLensService** - æ€ç»´é€é•œæœåŠ¡
3. **LLMPromptEngine** - Prompt å·¥ç¨‹å¼•æ“
4. **MetaViewFeedbackService** - ç”¨æˆ·åé¦ˆæœåŠ¡

---

## ğŸ’¾ ä¸‰ã€æ•°æ®åº“è®¾è®¡

### 3.1 ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 1
         â”‚
         â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   articles              â”‚
â”‚  (ç°æœ‰è¡¨,æ–°å¢å­—æ®µ)      â”‚
â”‚  + has_meta_analysis    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 1
         â”‚
         â”‚ 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   meta_analyses               â”‚
â”‚  - id                         â”‚
â”‚  - article_id (FK)            â”‚
â”‚  - author_intent              â”‚
â”‚  - timeliness_score           â”‚
â”‚  - bias_analysis              â”‚
â”‚  - knowledge_gaps             â”‚
â”‚  - raw_llm_response           â”‚
â”‚  - created_at                 â”‚
â”‚  - updated_at                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 1
         â”‚
         â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  thinking_lens_results        â”‚
â”‚  - id                         â”‚
â”‚  - meta_analysis_id (FK)      â”‚
â”‚  - lens_type                  â”‚
â”‚  - highlights                 â”‚
â”‚  - annotations                â”‚
â”‚  - created_at                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         users
           â”‚ 1
           â”‚
           â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  meta_view_feedback           â”‚
â”‚  - id                         â”‚
â”‚  - user_id (FK)               â”‚
â”‚  - meta_analysis_id (FK)      â”‚
â”‚  - feedback_type              â”‚
â”‚  - rating (1-5)               â”‚
â”‚  - comment                    â”‚
â”‚  - created_at                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è¡¨ç»“æ„è¯¦ç»†è®¾è®¡

#### 3.2.1 meta_analyses (å…ƒä¿¡æ¯åˆ†æè¡¨)

```sql
CREATE TABLE meta_analyses (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    article_id INTEGER NOT NULL UNIQUE,

    -- ä½œè€…æ„å›¾åˆ†æ
    author_intent JSON NOT NULL,
    -- ç»“æ„: {
    --   "primary": "inform|persuade|entertain|provoke",
    --   "confidence": 0.0-1.0,
    --   "description": "è¯¦ç»†è¯´æ˜",
    --   "indicators": ["æŒ‡æ ‡1", "æŒ‡æ ‡2"]
    -- }

    -- æ—¶æ•ˆæ€§è¯„ä¼°
    timeliness_score FLOAT NOT NULL,
    -- 0.0-1.0, 1.0è¡¨ç¤ºé«˜åº¦æ—¶æ•ˆæ•æ„Ÿ
    timeliness_analysis JSON NOT NULL,
    -- ç»“æ„: {
    --   "category": "timeless|evergreen|time-sensitive|breaking",
    --   "decay_rate": "low|medium|high",
    --   "best_before": "ISO 8601æ—¥æœŸæˆ–null",
    --   "context_dependencies": ["ä¾èµ–1", "ä¾èµ–2"]
    -- }

    -- æ½œåœ¨åè§æ£€æµ‹
    bias_analysis JSON NOT NULL,
    -- ç»“æ„: {
    --   "detected": true|false,
    --   "types": ["confirmation_bias", "political_bias", "cultural_bias"],
    --   "severity": "low|medium|high",
    --   "examples": [
    --     {"text": "åŸæ–‡ç‰‡æ®µ", "type": "åè§ç±»å‹", "explanation": "è¯´æ˜"}
    --   ],
    --   "overall_balance": "balanced|slightly_biased|heavily_biased"
    -- }

    -- çŸ¥è¯†ç¼ºå£æç¤º
    knowledge_gaps JSON NOT NULL,
    -- ç»“æ„: {
    --   "prerequisites": ["å‰ç½®çŸ¥è¯†1", "å‰ç½®çŸ¥è¯†2"],
    --   "assumptions": ["å‡è®¾1", "å‡è®¾2"],
    --   "missing_context": ["ç¼ºå¤±çš„èƒŒæ™¯1", "ç¼ºå¤±çš„èƒŒæ™¯2"],
    --   "related_concepts": ["ç›¸å…³æ¦‚å¿µ1", "ç›¸å…³æ¦‚å¿µ2"]
    -- }

    -- åŸå§‹LLMå“åº” (ç”¨äºè°ƒè¯•å’Œæ”¹è¿›)
    raw_llm_response TEXT,

    -- åˆ†æè´¨é‡æŒ‡æ ‡
    analysis_quality JSON,
    -- ç»“æ„: {
    --   "confidence_score": 0.0-1.0,
    --   "processing_time_ms": integer,
    --   "llm_model": "æ¨¡å‹åç§°",
    --   "prompt_version": "v1.0"
    -- }

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE,
    INDEX idx_article_id (article_id)
);
```

#### 3.2.2 thinking_lens_results (æ€ç»´é€é•œç»“æœè¡¨)

```sql
CREATE TABLE thinking_lens_results (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    meta_analysis_id INTEGER NOT NULL,
    lens_type VARCHAR(50) NOT NULL,
    -- 'argument_structure' | 'author_stance'

    -- é«˜äº®æ•°æ®
    highlights JSON NOT NULL,
    -- ç»“æ„: [
    --   {
    --     "start": integer,  // å­—ç¬¦åç§»é‡
    --     "end": integer,
    --     "text": "é«˜äº®æ–‡æœ¬",
    --     "category": "claim|evidence|subjective|objective|åè®½",
    --     "color": "#hexé¢œè‰²",
    --     "tooltip": "æç¤ºæ–‡æœ¬"
    --   }
    -- ]

    -- æ³¨é‡Šå’Œè¯´æ˜
    annotations JSON,
    -- ç»“æ„: {
    --   "summary": "é€é•œåˆ†ææ€»ç»“",
    --   "key_insights": ["æ´å¯Ÿ1", "æ´å¯Ÿ2"],
    --   "statistics": {
    --     "claim_count": integer,
    --     "evidence_count": integer,
    --     "claim_to_evidence_ratio": float
    --   }
    -- }

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (meta_analysis_id) REFERENCES meta_analyses(id) ON DELETE CASCADE,
    INDEX idx_meta_analysis (meta_analysis_id),
    INDEX idx_lens_type (lens_type),
    UNIQUE (meta_analysis_id, lens_type)
);
```

#### 3.2.3 meta_view_feedback (ç”¨æˆ·åé¦ˆè¡¨)

```sql
CREATE TABLE meta_view_feedback (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    meta_analysis_id INTEGER,
    lens_result_id INTEGER,

    feedback_type VARCHAR(50) NOT NULL,
    -- 'meta_info_card' | 'lens_highlight' | 'overall'

    rating INTEGER,
    -- 1-5, å¯é€‰

    comment TEXT,
    -- ç”¨æˆ·æ–‡å­—åé¦ˆï¼Œå¯é€‰

    feedback_data JSON,
    -- ç»“æ„åŒ–åé¦ˆæ•°æ®ï¼Œä¾‹å¦‚:
    -- {"helpful": true, "accurate": false, "specific_issue": "..."}

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (meta_analysis_id) REFERENCES meta_analyses(id) ON DELETE CASCADE,
    FOREIGN KEY (lens_result_id) REFERENCES thinking_lens_results(id) ON DELETE CASCADE,
    INDEX idx_user (user_id),
    INDEX idx_meta_analysis (meta_analysis_id),
    INDEX idx_created_at (created_at)
);
```

---

## ğŸ”Œ å››ã€API è®¾è®¡

### 4.1 å…ƒä¿¡æ¯åˆ†æ API

#### 4.1.1 è§¦å‘å…ƒä¿¡æ¯åˆ†æ

```http
POST /api/v1/meta-analysis/analyze
Content-Type: application/json
Authorization: Bearer {token}

{
  "article_id": 123,
  "full_text": "æ–‡ç« å®Œæ•´æ–‡æœ¬",
  "language": "zh",
  "force_reanalyze": false  // æ˜¯å¦å¼ºåˆ¶é‡æ–°åˆ†æ
}
```

**å“åº”**:
```json
{
  "status": "success|processing|cached",
  "message": "åˆ†æå®Œæˆ | æ­£åœ¨åå°åˆ†æ | ä½¿ç”¨ç¼“å­˜ç»“æœ",
  "meta_analysis": {
    "id": 456,
    "article_id": 123,
    "author_intent": {
      "primary": "inform",
      "confidence": 0.85,
      "description": "ä½œè€…æ—¨åœ¨å®¢è§‚ä»‹ç»æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†",
      "indicators": ["ä½¿ç”¨ä¸­æ€§è¯­è¨€", "æä¾›å¤§é‡æŠ€æœ¯ç»†èŠ‚", "é¿å…ä»·å€¼åˆ¤æ–­"]
    },
    "timeliness_score": 0.4,
    "timeliness_analysis": {
      "category": "evergreen",
      "decay_rate": "low",
      "best_before": null,
      "context_dependencies": []
    },
    "bias_analysis": {
      "detected": false,
      "types": [],
      "severity": "low",
      "examples": [],
      "overall_balance": "balanced"
    },
    "knowledge_gaps": {
      "prerequisites": ["åŸºç¡€æ•°å­¦", "çº¿æ€§ä»£æ•°"],
      "assumptions": ["è¯»è€…äº†è§£ç¼–ç¨‹"],
      "missing_context": [],
      "related_concepts": ["ç¥ç»ç½‘ç»œ", "åå‘ä¼ æ’­"]
    },
    "analysis_quality": {
      "confidence_score": 0.88,
      "processing_time_ms": 3500,
      "llm_model": "gpt-4o",
      "prompt_version": "v1.0"
    }
  }
}
```

#### 4.1.2 è·å–å…ƒä¿¡æ¯åˆ†æç»“æœ

```http
GET /api/v1/meta-analysis/{article_id}
Authorization: Bearer {token}
```

**å“åº”**:
```json
{
  "exists": true,
  "meta_analysis": { /* åŒä¸Š */ }
}
```

### 4.2 æ€ç»´é€é•œ API

#### 4.2.1 åº”ç”¨æ€ç»´é€é•œ

```http
POST /api/v1/thinking-lens/apply
Content-Type: application/json
Authorization: Bearer {token}

{
  "article_id": 123,
  "lens_type": "argument_structure",  // 'argument_structure' | 'author_stance'
  "full_text": "æ–‡ç« å®Œæ•´æ–‡æœ¬"
}
```

**å“åº”**:
```json
{
  "status": "success",
  "lens_result": {
    "id": 789,
    "lens_type": "argument_structure",
    "highlights": [
      {
        "start": 50,
        "end": 120,
        "text": "æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªåˆ†æ”¯",
        "category": "claim",
        "color": "#dbeafe",
        "tooltip": "æ ¸å¿ƒè§‚ç‚¹ï¼šå®šä¹‰æ·±åº¦å­¦ä¹ "
      },
      {
        "start": 150,
        "end": 250,
        "text": "ç ”ç©¶è¡¨æ˜ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œåœ¨å›¾åƒè¯†åˆ«ä»»åŠ¡ä¸Šè¾¾åˆ°äº†è¶…è¶Šäººç±»çš„å‡†ç¡®ç‡",
        "category": "evidence",
        "color": "#d1fae5",
        "tooltip": "è¯æ®ï¼šå¼•ç”¨ç ”ç©¶ç»“æœ"
      }
    ],
    "annotations": {
      "summary": "æ–‡ç« é‡‡ç”¨\"ä¸»å¼ -è¯æ®\"ç»“æ„ï¼Œé€»è¾‘æ¸…æ™°",
      "key_insights": [
        "å…±è¯†åˆ«3ä¸ªæ ¸å¿ƒä¸»å¼ ",
        "æ¯ä¸ªä¸»å¼ éƒ½æœ‰ç›¸åº”è¯æ®æ”¯æ’‘",
        "ä¸»å¼ -è¯æ®æ¯”ä¾‹: 1:1.5"
      ],
      "statistics": {
        "claim_count": 3,
        "evidence_count": 5,
        "claim_to_evidence_ratio": 1.67
      }
    }
  }
}
```

### 4.3 ç”¨æˆ·åé¦ˆ API

#### 4.3.1 æäº¤åé¦ˆ

```http
POST /api/v1/meta-analysis/feedback
Content-Type: application/json
Authorization: Bearer {token}

{
  "meta_analysis_id": 456,
  "lens_result_id": 789,  // å¯é€‰
  "feedback_type": "lens_highlight",
  "rating": 4,
  "comment": "é«˜äº®å¾ˆå‡†ç¡®ï¼Œä½†æœ‰ä¸€å¤„è¯¯åˆ¤",
  "feedback_data": {
    "helpful": true,
    "accurate": true,
    "specific_issue": "ç¬¬3ä¸ªé«˜äº®åº”è¯¥æ˜¯evidenceè€Œéclaim"
  }
}
```

**å“åº”**:
```json
{
  "status": "success",
  "message": "æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼"
}
```

---

## ğŸ¨ äº”ã€UI/UX è¯¦ç»†è®¾è®¡

### 5.1 è§¦å‘å™¨ (Trigger)

#### è§†è§‰è®¾è®¡
```
é»˜è®¤çŠ¶æ€:
â”Œâ”€â”€â”€â”€â”
â”‚ ğŸ‘“ â”‚  <- åŠé€æ˜ï¼Œopacity: 0.4
â””â”€â”€â”€â”€â”˜

æ‚¬åœçŠ¶æ€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘“ å¼€å¯å…ƒè§†è§’ â”‚  <- å®ä½“ï¼Œopacity: 1.0ï¼Œæ˜¾ç¤ºæ–‡å­—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŠ è½½çŠ¶æ€:
â”Œâ”€â”€â”€â”€â”
â”‚ âŸ³  â”‚  <- æ—‹è½¬åŠ¨ç”»ï¼Œæç¤ºåˆ†æä¸­
â””â”€â”€â”€â”€â”˜

æ¿€æ´»çŠ¶æ€:
â”Œâ”€â”€â”€â”€â”
â”‚ âœ•  â”‚  <- å˜ä¸ºå…³é—­æŒ‰é’®
â””â”€â”€â”€â”€â”˜
```

#### å®šä½å’Œæ ·å¼
```vue
<template>
  <button
    @click="toggleMetaView"
    :class="[
      'fixed z-50 w-12 h-12 rounded-full shadow-lg transition-all duration-300',
      'bg-gradient-to-br from-violet-500/80 to-purple-600/80 backdrop-blur-md',
      'hover:from-violet-600 hover:to-purple-700 hover:shadow-xl hover:scale-110',
      'bottom-24 right-8',  // å³ä¸‹è§’ï¼Œé¿å¼€ç«èŠ±åˆ†ææŒ‰é’®
      isActive ? 'opacity-100' : 'opacity-40 hover:opacity-100'
    ]"
  >
    <svg v-if="!isLoading && !isActive" class="w-6 h-6 text-white mx-auto">
      <!-- çœ¼é•œå›¾æ ‡ -->
    </svg>
    <svg v-else-if="isLoading" class="w-6 h-6 text-white animate-spin mx-auto">
      <!-- åŠ è½½å›¾æ ‡ -->
    </svg>
    <svg v-else class="w-6 h-6 text-white mx-auto">
      <!-- å…³é—­å›¾æ ‡ -->
    </svg>
  </button>

  <!-- æ‚¬åœæç¤º -->
  <Transition name="fade">
    <div
      v-if="showTooltip"
      class="fixed bottom-24 right-24 px-3 py-1.5 bg-gray-900 text-white text-xs rounded-lg"
    >
      {{ isActive ? 'å…³é—­å…ƒè§†è§’' : 'å¼€å¯å…ƒè§†è§’' }}
    </div>
  </Transition>
</template>
```

### 5.2 å…ƒä¿¡æ¯é¢æ¿ (Meta-Info Panel)

#### å¸ƒå±€ç»“æ„
```
æ¡Œé¢ç«¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  â”‚  å…ƒä¿¡æ¯é¢æ¿ (400px)  â”‚
â”‚         æ–‡ç« é˜…è¯»åŒº               â”‚                      â”‚
â”‚       (å®½åº¦åŠ¨æ€æ”¶ç¼©)             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                  â”‚  â”‚ å…ƒä¿¡æ¯å¡ç‰‡ 1   â”‚  â”‚
â”‚                                  â”‚  â”‚ (ä½œè€…æ„å›¾)     â”‚  â”‚
â”‚                                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚                      â”‚
â”‚                                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                  â”‚  â”‚ å…ƒä¿¡æ¯å¡ç‰‡ 2   â”‚  â”‚
â”‚                                  â”‚  â”‚ (æ—¶æ•ˆæ€§)       â”‚  â”‚
â”‚                                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚                      â”‚
â”‚                                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                  â”‚  â”‚ æ€ç»´é€é•œåˆ‡æ¢   â”‚  â”‚
â”‚                                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç§»åŠ¨ç«¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ–‡ç« é˜…è¯»åŒº               â”‚
â”‚                                  â”‚
â”‚                                  â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å…ƒä¿¡æ¯é¢æ¿ (åº•éƒ¨æ»‘å‡º)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å…ƒä¿¡æ¯å¡ç‰‡ (å¯æ»‘åŠ¨)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ»‘å‡ºåŠ¨ç”»
```vue
<Transition
  enter-active-class="transition-all duration-300 ease-out"
  enter-from-class="translate-x-full"
  enter-to-class="translate-x-0"
  leave-active-class="transition-all duration-300 ease-in"
  leave-from-class="translate-x-0"
  leave-to-class="translate-x-full"
>
  <aside
    v-if="isMetaViewActive"
    class="fixed top-0 right-0 h-full w-[400px] bg-white/70 backdrop-blur-xl border-l border-gray-200/50 shadow-2xl overflow-y-auto z-40"
  >
    <!-- é¢æ¿å†…å®¹ -->
  </aside>
</Transition>
```

### 5.3 å…ƒä¿¡æ¯å¡ç‰‡ (Meta-Info Cards)

#### å¡ç‰‡ç»„ä»¶æ¨¡æ¿
```vue
<template>
  <div class="mb-4 bg-white/80 backdrop-blur-md border border-gray-200/50 rounded-2xl p-5 shadow-sm hover:shadow-md transition-all">
    <!-- å¡ç‰‡å¤´éƒ¨ -->
    <div class="flex items-center justify-between mb-3">
      <div class="flex items-center gap-2">
        <div :class="['w-8 h-8 rounded-lg flex items-center justify-center', iconBgClass]">
          <component :is="icon" class="w-5 h-5 text-white" />
        </div>
        <h4 class="text-sm font-semibold text-gray-800">{{ title }}</h4>
      </div>

      <!-- ç½®ä¿¡åº¦æŒ‡ç¤ºå™¨ -->
      <div v-if="confidence" class="flex items-center gap-1">
        <div class="w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden">
          <div
            :class="['h-full rounded-full transition-all', confidenceColorClass]"
            :style="{ width: `${confidence * 100}%` }"
          ></div>
        </div>
        <span class="text-xs text-gray-500">{{ Math.round(confidence * 100) }}%</span>
      </div>
    </div>

    <!-- å¡ç‰‡å†…å®¹ -->
    <div class="space-y-2">
      <slot />
    </div>

    <!-- åé¦ˆæŒ‰é’® -->
    <div class="mt-3 flex items-center justify-end gap-2">
      <button
        @click="$emit('feedback', 'helpful')"
        class="p-1.5 rounded-lg hover:bg-gray-100 transition-colors"
        title="æœ‰å¸®åŠ©"
      >
        <ThumbsUpIcon class="w-4 h-4 text-gray-400 hover:text-emerald-600" />
      </button>
      <button
        @click="$emit('feedback', 'not-helpful')"
        class="p-1.5 rounded-lg hover:bg-gray-100 transition-colors"
        title="ä¸å‡†ç¡®"
      >
        <ThumbsDownIcon class="w-4 h-4 text-gray-400 hover:text-red-600" />
      </button>
    </div>
  </div>
</template>
```

#### å…·ä½“å¡ç‰‡ç¤ºä¾‹

**ä½œè€…æ„å›¾å¡ç‰‡**:
```vue
<MetaInfoCard
  title="ä½œè€…æ„å›¾"
  icon="TargetIcon"
  :confidence="authorIntent.confidence"
  icon-bg-class="bg-gradient-to-br from-violet-500 to-purple-600"
>
  <div class="flex items-center gap-2 mb-2">
    <span class="px-3 py-1 bg-violet-100 text-violet-700 text-xs font-medium rounded-full">
      {{ intentLabel }}
    </span>
  </div>
  <p class="text-sm text-gray-700 leading-relaxed">
    {{ authorIntent.description }}
  </p>
  <div v-if="authorIntent.indicators.length > 0" class="mt-2">
    <p class="text-xs text-gray-500 mb-1">è¯†åˆ«ä¾æ®:</p>
    <ul class="space-y-1">
      <li
        v-for="(indicator, index) in authorIntent.indicators"
        :key="index"
        class="text-xs text-gray-600 flex items-start gap-1"
      >
        <span class="text-violet-500 mt-0.5">â€¢</span>
        <span>{{ indicator }}</span>
      </li>
    </ul>
  </div>
</MetaInfoCard>
```

**æ—¶æ•ˆæ€§è¯„ä¼°å¡ç‰‡**:
```vue
<MetaInfoCard
  title="æ—¶æ•ˆæ€§è¯„ä¼°"
  icon="ClockIcon"
  :confidence="timelinessScore"
  icon-bg-class="bg-gradient-to-br from-amber-500 to-orange-600"
>
  <div class="flex items-center gap-2 mb-2">
    <span :class="[
      'px-3 py-1 text-xs font-medium rounded-full',
      categoryColorClass
    ]">
      {{ categoryLabel }}
    </span>
  </div>

  <!-- æ—¶æ•ˆæ€§æ¡å½¢å›¾ -->
  <div class="relative h-2 bg-gray-200 rounded-full overflow-hidden mb-3">
    <div
      :class="['h-full rounded-full transition-all', scoreColorClass]"
      :style="{ width: `${timelinessScore * 100}%` }"
    ></div>
  </div>

  <div class="space-y-2 text-sm">
    <div class="flex items-center justify-between">
      <span class="text-gray-600">è¡°å‡é€Ÿåº¦:</span>
      <span class="font-medium text-gray-800">{{ decayRateLabel }}</span>
    </div>
    <div v-if="bestBefore" class="flex items-center justify-between">
      <span class="text-gray-600">æœ‰æ•ˆæœŸè‡³:</span>
      <span class="font-medium text-gray-800">{{ formatDate(bestBefore) }}</span>
    </div>
  </div>

  <div v-if="contextDependencies.length > 0" class="mt-3 p-3 bg-amber-50/50 rounded-lg">
    <p class="text-xs text-amber-800 font-medium mb-1">æ—¶æ•ˆæ€§ä¾èµ–:</p>
    <ul class="space-y-1">
      <li
        v-for="dep in contextDependencies"
        :key="dep"
        class="text-xs text-amber-700"
      >
        â€¢ {{ dep }}
      </li>
    </ul>
  </div>
</MetaInfoCard>
```

### 5.4 æ€ç»´é€é•œåˆ‡æ¢å™¨ (Thinking Lens Switcher)

```vue
<template>
  <div class="mt-6 bg-gradient-to-br from-slate-50/50 to-zinc-50/50 border border-gray-200/50 rounded-2xl p-5">
    <h4 class="text-sm font-semibold text-gray-800 mb-4 flex items-center gap-2">
      <EyeIcon class="w-5 h-5 text-violet-600" />
      æ€ç»´é€é•œ
    </h4>

    <div class="space-y-2">
      <!-- è®ºè¯ç»“æ„é€é•œ -->
      <button
        @click="toggleLens('argument_structure')"
        :class="[
          'w-full p-3 rounded-xl border-2 transition-all text-left',
          activeLens === 'argument_structure'
            ? 'border-blue-500 bg-blue-50/50 shadow-sm'
            : 'border-gray-200 hover:border-blue-300 hover:bg-blue-50/30'
        ]"
      >
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-gray-800">è®ºè¯ç»“æ„</span>
          <div v-if="activeLens === 'argument_structure'" class="flex items-center gap-1 text-xs text-blue-600">
            <CheckCircleIcon class="w-4 h-4" />
            <span>å·²æ¿€æ´»</span>
          </div>
        </div>
        <p class="text-xs text-gray-600 mb-2">
          è¯†åˆ«æ–‡ç« çš„æ ¸å¿ƒä¸»å¼ ä¸æ”¯æ’‘è¯æ®
        </p>

        <!-- å›¾ä¾‹ -->
        <div v-if="activeLens === 'argument_structure'" class="flex items-center gap-3 text-xs">
          <div class="flex items-center gap-1">
            <div class="w-3 h-3 rounded bg-blue-200"></div>
            <span class="text-gray-600">ä¸»å¼ </span>
          </div>
          <div class="flex items-center gap-1">
            <div class="w-3 h-3 rounded bg-green-200"></div>
            <span class="text-gray-600">è¯æ®</span>
          </div>
        </div>
      </button>

      <!-- ä½œè€…ç«‹åœºé€é•œ -->
      <button
        @click="toggleLens('author_stance')"
        :class="[
          'w-full p-3 rounded-xl border-2 transition-all text-left',
          activeLens === 'author_stance'
            ? 'border-yellow-500 bg-yellow-50/50 shadow-sm'
            : 'border-gray-200 hover:border-yellow-300 hover:bg-yellow-50/30'
        ]"
      >
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-gray-800">ä½œè€…ç«‹åœº</span>
          <div v-if="activeLens === 'author_stance'" class="flex items-center gap-1 text-xs text-yellow-600">
            <CheckCircleIcon class="w-4 h-4" />
            <span>å·²æ¿€æ´»</span>
          </div>
        </div>
        <p class="text-xs text-gray-600 mb-2">
          åŒºåˆ†äº‹å®é™ˆè¿°ä¸ä¸»è§‚è§‚ç‚¹
        </p>

        <!-- å›¾ä¾‹ -->
        <div v-if="activeLens === 'author_stance'" class="flex items-center gap-3 text-xs">
          <div class="flex items-center gap-1">
            <div class="w-3 h-3 rounded bg-yellow-200"></div>
            <span class="text-gray-600">ä¸»è§‚</span>
          </div>
          <div class="flex items-center gap-1">
            <div class="w-3 h-3 rounded bg-gray-200"></div>
            <span class="text-gray-600">å®¢è§‚</span>
          </div>
        </div>
      </button>
    </div>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <div v-if="activeLens && lensStats" class="mt-4 p-3 bg-white/60 rounded-lg border border-gray-200/50">
      <p class="text-xs text-gray-600 mb-2">ç»Ÿè®¡ä¿¡æ¯:</p>
      <div class="grid grid-cols-2 gap-2 text-xs">
        <div v-for="(value, key) in lensStats" :key="key">
          <span class="text-gray-500">{{ key }}:</span>
          <span class="ml-1 font-medium text-gray-800">{{ value }}</span>
        </div>
      </div>
    </div>
  </div>
</template>
```

### 5.5 æ–‡ç« é«˜äº®æ¸²æŸ“

#### é«˜äº®é¢œè‰²ç³»ç»Ÿ
```typescript
const HIGHLIGHT_COLORS = {
  // è®ºè¯ç»“æ„é€é•œ
  argument_structure: {
    claim: {
      bg: 'rgba(191, 219, 254, 0.4)',      // æ·¡è“è‰² (blue-200/40)
      border: 'rgba(59, 130, 246, 0.3)',   // è“è‰²è¾¹æ¡†
      tooltip: 'æ ¸å¿ƒä¸»å¼ '
    },
    evidence: {
      bg: 'rgba(209, 250, 229, 0.4)',      // æ·¡ç»¿è‰² (green-200/40)
      border: 'rgba(34, 197, 94, 0.3)',    // ç»¿è‰²è¾¹æ¡†
      tooltip: 'æ”¯æ’‘è¯æ®'
    }
  },

  // ä½œè€…ç«‹åœºé€é•œ
  author_stance: {
    subjective: {
      bg: 'rgba(254, 240, 138, 0.4)',      // æ·¡é»„è‰² (yellow-200/40)
      border: 'rgba(234, 179, 8, 0.3)',    // é»„è‰²è¾¹æ¡†
      tooltip: 'ä¸»è§‚è¡¨è¾¾'
    },
    objective: {
      bg: 'rgba(226, 232, 240, 0.4)',      // æ·¡ç°è‰² (slate-200/40)
      border: 'rgba(100, 116, 139, 0.3)',  // ç°è‰²è¾¹æ¡†
      tooltip: 'å®¢è§‚é™ˆè¿°'
    },
    irony: {
      bg: 'rgba(253, 224, 71, 0.4)',       // æ·¡é»„è‰² (yellow-300/40)
      border: 'rgba(234, 179, 8, 0.4)',    // é»„è‰²è¾¹æ¡†
      tooltip: 'åè®½/è®½åˆº'
    }
  }
}
```

#### é«˜äº®å®ç°é€»è¾‘
```typescript
// composables/useThinkingLens.ts
export const useThinkingLens = () => {
  const applyHighlights = (containerEl: HTMLElement, highlights: Highlight[]) => {
    // æ¸…é™¤æ—§é«˜äº®
    removeOldHighlights(containerEl)

    // æŒ‰ä½ç½®ä»åå¾€å‰æ’åºï¼ˆé¿å…ä½ç½®åç§»ï¼‰
    const sortedHighlights = [...highlights].sort((a, b) => b.start - a.start)

    // æ”¶é›†æ–‡æœ¬èŠ‚ç‚¹
    const textNodes = collectTextNodes(containerEl)

    // åº”ç”¨é«˜äº®
    for (const highlight of sortedHighlights) {
      const targetNode = findNodeByOffset(textNodes, highlight.start)
      if (!targetNode) continue

      // åˆ›å»ºé«˜äº®å…ƒç´ 
      const highlightEl = createHighlightElement(highlight)

      // æ’å…¥DOM
      insertHighlight(targetNode, highlight, highlightEl)
    }
  }

  const createHighlightElement = (highlight: Highlight): HTMLElement => {
    const span = document.createElement('span')
    span.className = 'meta-view-highlight'
    span.dataset.category = highlight.category
    span.dataset.lensType = highlight.lensType

    const colorScheme = HIGHLIGHT_COLORS[highlight.lensType][highlight.category]
    span.style.backgroundColor = colorScheme.bg
    span.style.borderBottom = `2px solid ${colorScheme.border}`
    span.style.cursor = 'pointer'
    span.textContent = highlight.text

    // æ·»åŠ  tooltip
    span.title = highlight.tooltip || colorScheme.tooltip

    // æ‚¬åœæ•ˆæœ
    span.addEventListener('mouseenter', () => {
      span.style.backgroundColor = colorScheme.bg.replace('0.4', '0.6')
    })
    span.addEventListener('mouseleave', () => {
      span.style.backgroundColor = colorScheme.bg
    })

    return span
  }

  return {
    applyHighlights,
    removeHighlights: () => removeOldHighlights(containerEl)
  }
}
```

---

## ğŸ¤– å…­ã€LLM Prompt å·¥ç¨‹

### 6.1 Prompt è®¾è®¡åŸåˆ™

1. **ç»“æ„åŒ–è¾“å‡ºå¼ºåˆ¶**: ä½¿ç”¨ OpenAI çš„ JSON mode æˆ– Function Calling
2. **æ€ç»´é“¾å¼•å¯¼**: å…ˆåˆ†æï¼Œå†å½’çº³ï¼Œæœ€åè¾“å‡º
3. **Few-shot ç¤ºä¾‹**: æä¾›2-3ä¸ªé«˜è´¨é‡ç¤ºä¾‹
4. **æ˜ç¡®çº¦æŸ**: æ¸…æ™°å®šä¹‰æ¯ä¸ªå­—æ®µçš„å–å€¼èŒƒå›´å’Œæ ¼å¼
5. **é˜²å¾¡æ€§è®¾è®¡**: å¤„ç†è¾¹ç¼˜æƒ…å†µå’Œæ¨¡ç³Šæ–‡æœ¬

### 6.2 å…ƒä¿¡æ¯åˆ†æ Prompt

```python
META_ANALYSIS_SYSTEM_PROMPT = """
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ–‡æœ¬åˆ†æä¸“å®¶ï¼Œæ“…é•¿è¯†åˆ«æ–‡ç« çš„å…ƒä¿¡æ¯ï¼ˆä½œè€…æ„å›¾ã€æ—¶æ•ˆæ€§ã€æ½œåœ¨åè§ç­‰ï¼‰ã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ·±å…¥åˆ†æç”¨æˆ·æä¾›çš„æ–‡ç« ï¼Œå¹¶ä»¥JSONæ ¼å¼è¾“å‡ºç»“æ„åŒ–çš„å…ƒä¿¡æ¯åˆ†æç»“æœã€‚

# åˆ†æç»´åº¦

1. **ä½œè€…æ„å›¾ (Author Intent)**
   - ä¸»è¦æ„å›¾ç±»å‹ï¼šinform (å‘ŠçŸ¥), persuade (è¯´æœ), entertain (å¨±ä¹), provoke (æ¿€å‘æ€è€ƒ)
   - ç½®ä¿¡åº¦ï¼š0.0-1.0
   - è¯¦ç»†è¯´æ˜ï¼š100å­—ä»¥å†…
   - è¯†åˆ«ä¾æ®ï¼šåˆ—å‡º3-5ä¸ªå…³é”®æŒ‡æ ‡

2. **æ—¶æ•ˆæ€§ (Timeliness)**
   - æ—¶æ•ˆæ€§åˆ†æ•°ï¼š0.0-1.0 (0è¡¨ç¤ºæ°¸æ’å†…å®¹ï¼Œ1è¡¨ç¤ºé«˜åº¦æ—¶æ•ˆæ•æ„Ÿ)
   - ç±»åˆ«ï¼štimeless (æ°¸æ’), evergreen (å¸¸é’), time-sensitive (æ—¶æ•ˆæ•æ„Ÿ), breaking (çªå‘æ–°é—»)
   - è¡°å‡é€Ÿåº¦ï¼šlow (æ…¢), medium (ä¸­ç­‰), high (å¿«)
   - æœ‰æ•ˆæœŸï¼šISO 8601æ—¥æœŸæˆ–null
   - æ—¶æ•ˆä¾èµ–ï¼šåˆ—å‡ºå½±å“æ—¶æ•ˆæ€§çš„å…³é”®å› ç´ 

3. **æ½œåœ¨åè§ (Bias)**
   - æ˜¯å¦æ£€æµ‹åˆ°åè§ï¼štrue/false
   - åè§ç±»å‹ï¼šconfirmation_bias, political_bias, cultural_bias, selection_biasç­‰
   - ä¸¥é‡ç¨‹åº¦ï¼šlow, medium, high
   - å…·ä½“æ¡ˆä¾‹ï¼šæ¯ä¸ªæ¡ˆä¾‹åŒ…å«åŸæ–‡ç‰‡æ®µã€åè§ç±»å‹å’Œè¯´æ˜
   - æ•´ä½“å¹³è¡¡æ€§ï¼šbalanced, slightly_biased, heavily_biased

4. **çŸ¥è¯†ç¼ºå£ (Knowledge Gaps)**
   - å‰ç½®çŸ¥è¯†ï¼šåˆ—å‡ºé˜…è¯»æœ¬æ–‡éœ€è¦çš„èƒŒæ™¯çŸ¥è¯†
   - éšå«å‡è®¾ï¼šåˆ—å‡ºä½œè€…æœªæ˜è¯´çš„å‡è®¾
   - ç¼ºå¤±èƒŒæ™¯ï¼šæŒ‡å‡ºæ–‡ä¸­æœªæåŠä½†é‡è¦çš„ä¸Šä¸‹æ–‡
   - ç›¸å…³æ¦‚å¿µï¼šåˆ—å‡ºå¯æ‰©å±•é˜…è¯»çš„ç›¸å…³ä¸»é¢˜

# è¾“å‡ºæ ¼å¼

å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSON schemaè¾“å‡ºï¼š

{
  "author_intent": {
    "primary": "inform|persuade|entertain|provoke",
    "confidence": 0.0-1.0,
    "description": "string",
    "indicators": ["string"]
  },
  "timeliness": {
    "score": 0.0-1.0,
    "category": "timeless|evergreen|time-sensitive|breaking",
    "decay_rate": "low|medium|high",
    "best_before": "ISO 8601 date or null",
    "context_dependencies": ["string"]
  },
  "bias": {
    "detected": true|false,
    "types": ["string"],
    "severity": "low|medium|high",
    "examples": [
      {
        "text": "string",
        "type": "string",
        "explanation": "string"
      }
    ],
    "overall_balance": "balanced|slightly_biased|heavily_biased"
  },
  "knowledge_gaps": {
    "prerequisites": ["string"],
    "assumptions": ["string"],
    "missing_context": ["string"],
    "related_concepts": ["string"]
  }
}

# æ³¨æ„äº‹é¡¹

- åˆ†æè¦å®¢è§‚ã€ä¸­ç«‹ï¼Œé¿å…ä¸»è§‚åˆ¤æ–­
- å¯¹äºä¸ç¡®å®šçš„åˆ†æï¼Œé™ä½ç½®ä¿¡åº¦
- åè§æ£€æµ‹è¦è°¨æ…ï¼Œé¿å…è¯¯æŠ¥
- æ‰€æœ‰åˆ—è¡¨å­—æ®µè‡³å°‘åŒ…å«1ä¸ªå…ƒç´ ï¼Œæœ€å¤š5ä¸ª
"""

META_ANALYSIS_USER_PROMPT_TEMPLATE = """
è¯·åˆ†æä»¥ä¸‹æ–‡ç« çš„å…ƒä¿¡æ¯ï¼š

---
æ ‡é¢˜ï¼š{title}
ä½œè€…ï¼š{author}
å‘å¸ƒæ—¶é—´ï¼š{publish_date}
è¯­è¨€ï¼š{language}

æ­£æ–‡ï¼š
{content}
---

è¯·æŒ‰ç…§ç³»ç»Ÿæç¤ºä¸­çš„JSON schemaè¾“å‡ºåˆ†æç»“æœã€‚
"""
```

### 6.3 è®ºè¯ç»“æ„é€é•œ Prompt

```python
ARGUMENT_LENS_SYSTEM_PROMPT = """
ä½ æ˜¯ä¸€ä½é€»è¾‘åˆ†æä¸“å®¶ï¼Œæ“…é•¿è¯†åˆ«æ–‡æœ¬ä¸­çš„è®ºè¯ç»“æ„ã€‚

ä½ çš„ä»»åŠ¡æ˜¯åˆ†ææ–‡ç« ï¼Œæ ‡æ³¨å‡ºï¼š
1. **æ ¸å¿ƒä¸»å¼  (Claims)**: ä½œè€…æƒ³è¦è¯æ˜æˆ–ä¼ è¾¾çš„æ ¸å¿ƒè§‚ç‚¹
2. **æ”¯æ’‘è¯æ® (Evidence)**: ç”¨äºæ”¯æŒä¸»å¼ çš„æ•°æ®ã€äº‹å®ã€ä¾‹å­ã€å¼•ç”¨ç­‰

# æ ‡æ³¨è§„åˆ™

- æ¯ä¸ªæ ‡æ³¨å¿…é¡»åŒ…å«ï¼šèµ·å§‹ä½ç½®ã€ç»“æŸä½ç½®ã€æ–‡æœ¬ç‰‡æ®µã€ç±»åˆ«ã€æç¤ºä¿¡æ¯
- ä½ç½®æ˜¯å­—ç¬¦çº§åç§»é‡ï¼ˆä»0å¼€å§‹ï¼‰
- ä¸»å¼ å’Œè¯æ®è¦å½¢æˆé€»è¾‘å¯¹åº”å…³ç³»
- é¿å…æ ‡æ³¨è¿‡çŸ­ï¼ˆ<10å­—ç¬¦ï¼‰æˆ–è¿‡é•¿ï¼ˆ>200å­—ç¬¦ï¼‰çš„ç‰‡æ®µ

# è¾“å‡ºæ ¼å¼

{
  "highlights": [
    {
      "start": integer,
      "end": integer,
      "text": "string",
      "category": "claim|evidence",
      "tooltip": "string"
    }
  ],
  "annotations": {
    "summary": "string",
    "key_insights": ["string"],
    "statistics": {
      "claim_count": integer,
      "evidence_count": integer,
      "claim_to_evidence_ratio": float
    }
  }
}
"""

ARGUMENT_LENS_USER_PROMPT_TEMPLATE = """
è¯·åˆ†æä»¥ä¸‹æ–‡ç« çš„è®ºè¯ç»“æ„ï¼Œæ ‡æ³¨å‡ºæ ¸å¿ƒä¸»å¼ å’Œæ”¯æ’‘è¯æ®ï¼š

{content}

è¯·è¾“å‡ºJSONæ ¼å¼çš„åˆ†æç»“æœã€‚
"""
```

### 6.4 ä½œè€…ç«‹åœºé€é•œ Prompt

```python
STANCE_LENS_SYSTEM_PROMPT = """
ä½ æ˜¯ä¸€ä½è¯­è¨€å­¦ä¸“å®¶ï¼Œæ“…é•¿åŒºåˆ†æ–‡æœ¬ä¸­çš„ä¸»è§‚è¡¨è¾¾å’Œå®¢è§‚é™ˆè¿°ã€‚

ä½ çš„ä»»åŠ¡æ˜¯åˆ†ææ–‡ç« ï¼Œæ ‡æ³¨å‡ºï¼š
1. **ä¸»è§‚è¡¨è¾¾ (Subjective)**: åŒ…å«ä¸ªäººè§‚ç‚¹ã€ä»·å€¼åˆ¤æ–­ã€æƒ…æ„Ÿè‰²å½©çš„å¥å­
2. **å®¢è§‚é™ˆè¿° (Objective)**: ä¸­æ€§æè¿°äº‹å®çš„å¥å­
3. **åè®½/è®½åˆº (Irony)**: è¡¨é¢æ„æ€ä¸å®é™…æ„å›¾ç›¸åçš„è¡¨è¾¾

# æ ‡æ³¨è§„åˆ™

- ä¸»è§‚è¡¨è¾¾çš„æ ‡å¿—ï¼šæƒ…æ„Ÿè¯æ±‡ã€ä»·å€¼åˆ¤æ–­ã€æ¨¡ç³Šé™å®šè¯ï¼ˆ"æˆ‘è®¤ä¸º"ã€"å¯èƒ½"ã€"åº”è¯¥"ï¼‰
- å®¢è§‚é™ˆè¿°çš„æ ‡å¿—ï¼šå…·ä½“æ•°æ®ã€æ˜ç¡®äº‹å®ã€ä¸­æ€§åŠ¨è¯
- åè®½è¾ƒéš¾è¯†åˆ«ï¼Œéœ€ç»“åˆè¯­å¢ƒï¼Œä¸ç¡®å®šæ—¶ä¸æ ‡æ³¨
- æ¯ä¸ªå¥å­åªæ ‡æ³¨ä¸€æ¬¡ï¼Œé€‰æ‹©æœ€ä¸»è¦çš„ç±»åˆ«

# è¾“å‡ºæ ¼å¼

{
  "highlights": [
    {
      "start": integer,
      "end": integer,
      "text": "string",
      "category": "subjective|objective|irony",
      "tooltip": "string"
    }
  ],
  "annotations": {
    "summary": "string",
    "key_insights": ["string"],
    "statistics": {
      "subjective_count": integer,
      "objective_count": integer,
      "subjectivity_ratio": float
    }
  }
}
"""
```

### 6.5 Prompt è°ƒç”¨æµç¨‹

```python
# services/meta_analysis_service.py

from openai import OpenAI
import json

class MetaAnalysisService:
    def __init__(self, db: Session):
        self.db = db
        self.client = OpenAI(api_key=settings.openai_api_key)

    async def analyze_article(
        self,
        article_id: int,
        title: str,
        author: str,
        publish_date: str,
        content: str,
        language: str = "zh"
    ) -> dict:
        """å…ƒä¿¡æ¯åˆ†æ"""

        # æ„å»ºç”¨æˆ·æç¤º
        user_prompt = META_ANALYSIS_USER_PROMPT_TEMPLATE.format(
            title=title,
            author=author,
            publish_date=publish_date,
            language=language,
            content=content[:5000]  # é™åˆ¶é•¿åº¦ï¼Œé¿å…è¶…å‡ºtokené™åˆ¶
        )

        try:
            # è°ƒç”¨ OpenAI API (ä½¿ç”¨ JSON mode)
            response = self.client.chat.completions.create(
                model="gpt-4o",
                messages=[
                    {"role": "system", "content": META_ANALYSIS_SYSTEM_PROMPT},
                    {"role": "user", "content": user_prompt}
                ],
                response_format={"type": "json_object"},  # å¼ºåˆ¶JSONè¾“å‡º
                temperature=0.3,  # é™ä½éšæœºæ€§ï¼Œæé«˜ç¨³å®šæ€§
                max_tokens=2000
            )

            # è§£æå“åº”
            result = json.loads(response.choices[0].message.content)

            # éªŒè¯ç»“æ„
            self._validate_meta_analysis_result(result)

            # ä¿å­˜åˆ°æ•°æ®åº“
            meta_analysis = MetaAnalysis(
                article_id=article_id,
                author_intent=result['author_intent'],
                timeliness_score=result['timeliness']['score'],
                timeliness_analysis=result['timeliness'],
                bias_analysis=result['bias'],
                knowledge_gaps=result['knowledge_gaps'],
                raw_llm_response=response.choices[0].message.content,
                analysis_quality={
                    "confidence_score": result['author_intent']['confidence'],
                    "processing_time_ms": int(response.usage.total_tokens * 10),  # ä¼°ç®—
                    "llm_model": "gpt-4o",
                    "prompt_version": "v1.0"
                }
            )

            self.db.add(meta_analysis)
            self.db.commit()
            self.db.refresh(meta_analysis)

            return self._format_meta_analysis_response(meta_analysis)

        except Exception as e:
            logger.error(f"å…ƒä¿¡æ¯åˆ†æå¤±è´¥: {str(e)}")
            raise HTTPException(status_code=500, detail="å…ƒä¿¡æ¯åˆ†æå¤±è´¥")

    def _validate_meta_analysis_result(self, result: dict):
        """éªŒè¯LLMè¾“å‡ºç»“æ„"""
        required_keys = ['author_intent', 'timeliness', 'bias', 'knowledge_gaps']
        for key in required_keys:
            if key not in result:
                raise ValueError(f"ç¼ºå°‘å¿…éœ€å­—æ®µ: {key}")

        # éªŒè¯ä½œè€…æ„å›¾
        if result['author_intent']['primary'] not in ['inform', 'persuade', 'entertain', 'provoke']:
            raise ValueError("æ— æ•ˆçš„ä½œè€…æ„å›¾ç±»å‹")

        # éªŒè¯ç½®ä¿¡åº¦èŒƒå›´
        if not 0 <= result['author_intent']['confidence'] <= 1:
            raise ValueError("ç½®ä¿¡åº¦å¿…é¡»åœ¨0-1ä¹‹é—´")

        # ... æ›´å¤šéªŒè¯ ...
```

---

## ğŸš€ ä¸ƒã€å®æ–½è·¯çº¿å›¾

### 7.1 é˜¶æ®µåˆ’åˆ†

#### **Phase 1: MVP (æœ€å°å¯è¡Œäº§å“) - 2å‘¨**

**ç›®æ ‡**: éªŒè¯æ ¸å¿ƒåŠŸèƒ½å’Œç”¨æˆ·ä»·å€¼

**èŒƒå›´**:
- âœ… å…ƒè§†è§’è§¦å‘å™¨
- âœ… å…ƒä¿¡æ¯é¢æ¿æ»‘å‡ºåŠ¨ç”»
- âœ… 2ä¸ªå…ƒä¿¡æ¯å¡ç‰‡ï¼ˆä½œè€…æ„å›¾ + æ—¶æ•ˆæ€§ï¼‰
- âœ… 1ä¸ªæ€ç»´é€é•œï¼ˆè®ºè¯ç»“æ„ï¼‰
- âœ… åŸºç¡€é«˜äº®æ¸²æŸ“
- âœ… å…ƒä¿¡æ¯åˆ†æAPI
- âœ… æ•°æ®åº“åŸºç¡€è¡¨ç»“æ„

**ä¸åŒ…å«**:
- âŒ æ½œåœ¨åè§æ£€æµ‹
- âŒ çŸ¥è¯†ç¼ºå£æç¤º
- âŒ ä½œè€…ç«‹åœºé€é•œ
- âŒ ç”¨æˆ·åé¦ˆæœºåˆ¶
- âŒ æ€§èƒ½ä¼˜åŒ–

**äº¤ä»˜ç‰©**:
- å¯å·¥ä½œçš„åŸå‹
- æŠ€æœ¯è®¾è®¡æ–‡æ¡£
- API æ–‡æ¡£
- åˆæ­¥æµ‹è¯•æ•°æ®

---

#### **Phase 2: åŠŸèƒ½å®Œå–„ - 2å‘¨**

**ç›®æ ‡**: è¡¥å…¨æ‰€æœ‰è®¾è®¡åŠŸèƒ½

**èŒƒå›´**:
- âœ… æ½œåœ¨åè§æ£€æµ‹å¡ç‰‡
- âœ… çŸ¥è¯†ç¼ºå£æç¤ºå¡ç‰‡
- âœ… ä½œè€…ç«‹åœºé€é•œ
- âœ… ç”¨æˆ·åé¦ˆæŒ‰é’®å’ŒAPI
- âœ… é€é•œåˆ‡æ¢åŠ¨ç”»ä¼˜åŒ–
- âœ… ç§»åŠ¨ç«¯é€‚é…

**äº¤ä»˜ç‰©**:
- åŠŸèƒ½å®Œæ•´çš„äº§å“
- ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹

---

#### **Phase 3: ä¼˜åŒ–ä¸è¿­ä»£ - 1å‘¨**

**ç›®æ ‡**: æå‡æ€§èƒ½ã€ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒ

**èŒƒå›´**:
- âœ… Prompt è°ƒä¼˜ï¼ˆåŸºäºçœŸå®æ•°æ®ï¼‰
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ã€å¼‚æ­¥å¤„ç†ï¼‰
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… A/B æµ‹è¯•å‡†å¤‡
- âœ… æ•°æ®åˆ†æåŸ‹ç‚¹

**äº¤ä»˜ç‰©**:
- ç”Ÿäº§å°±ç»ªçš„ä»£ç 
- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
- è¿è¥æ•°æ®çœ‹æ¿

---

### 7.2 æŠ€æœ¯é£é™©ä¸åº”å¯¹

| é£é™© | å½±å“ | æ¦‚ç‡ | åº”å¯¹ç­–ç•¥ |
|------|------|------|---------|
| LLM è¾“å‡ºä¸ç¨³å®š | é«˜ | ä¸­ | 1. ä½¿ç”¨ JSON mode å¼ºåˆ¶ç»“æ„åŒ–è¾“å‡º<br>2. å¤šè½®éªŒè¯å’Œé‡è¯•æœºåˆ¶<br>3. é™çº§ç­–ç•¥ï¼šéƒ¨åˆ†åŠŸèƒ½å¤±è´¥ä¸å½±å“æ•´ä½“ |
| åˆ†æè€—æ—¶é•¿ | ä¸­ | é«˜ | 1. å¼‚æ­¥å¤„ç†ï¼Œå‰ç«¯æ˜¾ç¤ºåŠ è½½çŠ¶æ€<br>2. ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤åˆ†æ<br>3. åˆ†æ®µåˆ†æï¼ˆå…ˆå¿«é€Ÿåˆ†æï¼Œå†æ·±åº¦åˆ†æï¼‰ |
| æˆæœ¬è¿‡é«˜ | ä¸­ | ä¸­ | 1. åªå¯¹ä¿å­˜/æ”¶è—çš„æ–‡ç« è¿›è¡Œåˆ†æ<br>2. é™åˆ¶åˆ†æé¢‘æ¬¡ï¼ˆæ¯ç”¨æˆ·æ¯å¤©ä¸Šé™ï¼‰<br>3. ä½¿ç”¨æ›´ä¾¿å®œçš„æ¨¡å‹ï¼ˆgpt-3.5-turboï¼‰é™çº§ |
| é«˜äº®ä½ç½®åç§» | ä½ | ä½ | 1. ä½¿ç”¨å¥å£®çš„æ–‡æœ¬èŠ‚ç‚¹éå†ç®—æ³•<br>2. å……åˆ†æµ‹è¯•å„ç§HTMLç»“æ„<br>3. è¾¹ç•Œæƒ…å†µå¤„ç†ï¼ˆè·¨æ ‡ç­¾é«˜äº®ï¼‰ |
| ç”¨æˆ·ä½“éªŒå¤æ‚ | ä¸­ | ä¸­ | 1. æ¸è¿›å¼æŠ«éœ²ï¼Œé¿å…ä¿¡æ¯è¿‡è½½<br>2. æ¸…æ™°çš„è§†è§‰å±‚æ¬¡<br>3. ç”¨æˆ·å¼•å¯¼å’Œæ•™ç¨‹ |

---

## ğŸ“Š å…«ã€æ•°æ®åˆ†æä¸æŒ‡æ ‡

### 8.1 æ ¸å¿ƒæŒ‡æ ‡ (KPIs)

**ä½¿ç”¨ç‡æŒ‡æ ‡**:
- å…ƒè§†è§’æ¿€æ´»ç‡: é˜…è¯»æ–‡ç« çš„ç”¨æˆ·ä¸­ï¼Œç‚¹å‡»ğŸ‘“å›¾æ ‡çš„æ¯”ä¾‹
- é€é•œä½¿ç”¨ç‡: æ¿€æ´»å…ƒè§†è§’åï¼Œåˆ‡æ¢é€é•œçš„æ¯”ä¾‹
- å¹³å‡ä½¿ç”¨æ—¶é•¿: å…ƒè§†è§’é¢æ¿æ‰“å¼€çš„å¹³å‡æ—¶é•¿

**ä»·å€¼æŒ‡æ ‡**:
- ç”¨æˆ·åé¦ˆè¯„åˆ†: ğŸ‘/ğŸ‘ æ¯”ä¾‹
- åŠŸèƒ½ç•™å­˜ç‡: é¦–æ¬¡ä½¿ç”¨åï¼Œ7å¤©å†…å†æ¬¡ä½¿ç”¨çš„æ¯”ä¾‹
- æ·±åº¦é˜…è¯»è½¬åŒ–: ä½¿ç”¨å…ƒè§†è§’åï¼Œè¿›è¡Œç«èŠ±ç‚¹å‡»/æ”¶è—çš„æ¯”ä¾‹æå‡

**æ€§èƒ½æŒ‡æ ‡**:
- åˆ†æå¹³å‡è€—æ—¶: P50, P95, P99
- API æˆåŠŸç‡: åˆ†æè¯·æ±‚çš„æˆåŠŸç‡
- é«˜äº®æ¸²æŸ“æ€§èƒ½: å¤§æ–‡ç« ï¼ˆ>5000å­—ï¼‰çš„æ¸²æŸ“å¸§ç‡

### 8.2 åŸ‹ç‚¹æ–¹æ¡ˆ

```typescript
// å…ƒè§†è§’æ¿€æ´»
trackEvent('meta_view_activated', {
  article_id: number,
  trigger_source: 'button' | 'keyboard_shortcut',
  user_id: number,
  timestamp: Date
})

// é€é•œåˆ‡æ¢
trackEvent('thinking_lens_toggled', {
  article_id: number,
  lens_type: 'argument_structure' | 'author_stance',
  action: 'enabled' | 'disabled',
  user_id: number,
  timestamp: Date
})

// ç”¨æˆ·åé¦ˆ
trackEvent('meta_view_feedback_submitted', {
  article_id: number,
  feedback_type: 'meta_info_card' | 'lens_highlight',
  component: 'author_intent' | 'timeliness' | '...',
  rating: 1-5 | null,
  helpful: boolean,
  user_id: number,
  timestamp: Date
})

// åˆ†ææ€§èƒ½
trackEvent('meta_analysis_completed', {
  article_id: number,
  processing_time_ms: number,
  llm_model: string,
  success: boolean,
  error_type: string | null,
  timestamp: Date
})
```

---

## ğŸ“ ä¹ã€æœ€ä½³å®è·µä¸è§„èŒƒ

### 9.1 å‰ç«¯å¼€å‘è§„èŒƒ

**ç»„ä»¶æ‹†åˆ†åŸåˆ™**:
- å•ä¸€èŒè´£ï¼šæ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½æ¨¡å—
- å¯å¤ç”¨ï¼šMetaInfoCard è®¾è®¡ä¸ºé€šç”¨å¡ç‰‡ç»„ä»¶
- çŠ¶æ€éš”ç¦»ï¼šä½¿ç”¨ composables ç®¡ç†å¤æ‚çŠ¶æ€

**æ€§èƒ½ä¼˜åŒ–**:
```typescript
// ä½¿ç”¨ computed ç¼“å­˜è®¡ç®—ç»“æœ
const intentLabel = computed(() => {
  const labels = {
    inform: 'å‘ŠçŸ¥',
    persuade: 'è¯´æœ',
    entertain: 'å¨±ä¹',
    provoke: 'æ¿€å‘æ€è€ƒ'
  }
  return labels[authorIntent.value.primary]
})

// ä½¿ç”¨ debounce é¿å…é¢‘ç¹APIè°ƒç”¨
const debouncedAnalyze = debounce(async () => {
  await analyzeArticle(articleId.value)
}, 500)

// è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚æœå…ƒä¿¡æ¯å¡ç‰‡å¾ˆå¤šï¼‰
import { useVirtualList } from '@vueuse/core'
const { list, containerProps, wrapperProps } = useVirtualList(metaCards, {
  itemHeight: 200
})
```

**é”™è¯¯å¤„ç†**:
```typescript
try {
  await analyzeArticle(articleId.value)
} catch (error) {
  if (error.response?.status === 429) {
    // é™æµé”™è¯¯
    showNotification('åˆ†æè¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•', 'warning')
  } else if (error.response?.status === 500) {
    // æœåŠ¡å™¨é”™è¯¯
    showNotification('åˆ†æå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error')
  } else {
    // å…¶ä»–é”™è¯¯
    showNotification('æœªçŸ¥é”™è¯¯', 'error')
  }

  // è®°å½•é”™è¯¯æ—¥å¿—
  logError('meta_view_error', {
    article_id: articleId.value,
    error: error.message,
    stack: error.stack
  })
}
```

### 9.2 åç«¯å¼€å‘è§„èŒƒ

**Prompt ç‰ˆæœ¬ç®¡ç†**:
```python
# ä½¿ç”¨ç‰ˆæœ¬å·ç®¡ç† Prompt
PROMPT_VERSIONS = {
    "v1.0": {
        "meta_analysis": META_ANALYSIS_SYSTEM_PROMPT_V1,
        "argument_lens": ARGUMENT_LENS_SYSTEM_PROMPT_V1
    },
    "v1.1": {
        "meta_analysis": META_ANALYSIS_SYSTEM_PROMPT_V1_1,
        "argument_lens": ARGUMENT_LENS_SYSTEM_PROMPT_V1_1
    }
}

def get_prompt(prompt_type: str, version: str = "latest"):
    if version == "latest":
        version = max(PROMPT_VERSIONS.keys())
    return PROMPT_VERSIONS[version][prompt_type]
```

**é‡è¯•æœºåˆ¶**:
```python
from tenacity import retry, stop_after_attempt, wait_exponential

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=2, max=10),
    reraise=True
)
async def call_openai_api(messages: list) -> dict:
    response = await self.client.chat.completions.create(
        model="gpt-4o",
        messages=messages,
        response_format={"type": "json_object"},
        temperature=0.3
    )
    return json.loads(response.choices[0].message.content)
```

**æˆæœ¬æ§åˆ¶**:
```python
# é™æµè£…é¥°å™¨
from functools import wraps
from datetime import datetime, timedelta

def rate_limit(max_calls: int, period: timedelta):
    """é™åˆ¶APIè°ƒç”¨é¢‘ç‡"""
    def decorator(func):
        calls = {}

        @wraps(func)
        async def wrapper(user_id: int, *args, **kwargs):
            now = datetime.utcnow()

            # æ¸…ç†è¿‡æœŸè®°å½•
            calls[user_id] = [
                call_time for call_time in calls.get(user_id, [])
                if now - call_time < period
            ]

            # æ£€æŸ¥æ˜¯å¦è¶…é™
            if len(calls.get(user_id, [])) >= max_calls:
                raise HTTPException(
                    status_code=429,
                    detail=f"æ¯{period.total_seconds()}ç§’æœ€å¤šè°ƒç”¨{max_calls}æ¬¡"
                )

            # è®°å½•æœ¬æ¬¡è°ƒç”¨
            calls.setdefault(user_id, []).append(now)

            return await func(user_id, *args, **kwargs)

        return wrapper
    return decorator

@rate_limit(max_calls=10, period=timedelta(hours=1))
async def analyze_article(user_id: int, article_id: int):
    # ... åˆ†æé€»è¾‘ ...
```

---

## ğŸ“ åã€æ–‡æ¡£ä¸åŸ¹è®­

### 10.1 éœ€è¦äº§å‡ºçš„æ–‡æ¡£

1. **æŠ€æœ¯è®¾è®¡æ–‡æ¡£** (æœ¬æ–‡æ¡£)
2. **API å‚è€ƒæ–‡æ¡£**
3. **å‰ç«¯ç»„ä»¶ä½¿ç”¨æŒ‡å—**
4. **Prompt å·¥ç¨‹æ‰‹å†Œ**
5. **ç”¨æˆ·ä½¿ç”¨æŒ‡å—**
6. **è¿ç»´æ‰‹å†Œ**

### 10.2 å›¢é˜ŸåŸ¹è®­è®¡åˆ’

**å¼€å‘å›¢é˜Ÿ**:
- Prompt å·¥ç¨‹åŸ¹è®­ï¼ˆ2å°æ—¶ï¼‰
- LLM API æœ€ä½³å®è·µï¼ˆ1å°æ—¶ï¼‰
- å‰ç«¯å¤æ‚çŠ¶æ€ç®¡ç†ï¼ˆ1.5å°æ—¶ï¼‰

**äº§å“/è®¾è®¡å›¢é˜Ÿ**:
- å…ƒè§†è§’åŠŸèƒ½æ¼”ç¤ºï¼ˆ30åˆ†é’Ÿï¼‰
- ç”¨æˆ·ä»·å€¼è®²è§£ï¼ˆ30åˆ†é’Ÿï¼‰
- æ•°æ®æŒ‡æ ‡è§£è¯»ï¼ˆ30åˆ†é’Ÿï¼‰

---

## âœ… åä¸€ã€éªŒæ”¶æ ‡å‡†

### 11.1 åŠŸèƒ½éªŒæ”¶

- [ ] ç”¨æˆ·å¯ä»¥ç‚¹å‡»ğŸ‘“å›¾æ ‡æ¿€æ´»å…ƒè§†è§’
- [ ] å…ƒä¿¡æ¯é¢æ¿å¹³æ»‘æ»‘å‡ºï¼Œæ–‡ç« åŒºåŸŸå®½åº¦ç›¸åº”ç¼©å°
- [ ] æ˜¾ç¤ºä½œè€…æ„å›¾ã€æ—¶æ•ˆæ€§ã€æ½œåœ¨åè§ã€çŸ¥è¯†ç¼ºå£å››å¼ å¡ç‰‡
- [ ] ç”¨æˆ·å¯ä»¥åˆ‡æ¢è®ºè¯ç»“æ„å’Œä½œè€…ç«‹åœºä¸¤ä¸ªé€é•œ
- [ ] æ¿€æ´»é€é•œåï¼Œæ–‡ç« ä¸­ç›¸åº”å†…å®¹è¢«æ­£ç¡®é«˜äº®
- [ ] é«˜äº®é¢œè‰²ç¬¦åˆè®¾è®¡è§„èŒƒï¼Œæ‚¬åœæœ‰è§†è§‰åé¦ˆ
- [ ] ç”¨æˆ·å¯ä»¥æäº¤åé¦ˆï¼ˆğŸ‘/ğŸ‘ï¼‰
- [ ] ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯å‡æ­£å¸¸æ˜¾ç¤º

### 11.2 æ€§èƒ½éªŒæ”¶

- [ ] å…ƒä¿¡æ¯åˆ†æå¹³å‡è€—æ—¶ < 5ç§’ï¼ˆP95ï¼‰
- [ ] é«˜äº®æ¸²æŸ“ä¸å¡é¡¿ï¼ˆ>30 FPSï¼‰
- [ ] API æˆåŠŸç‡ > 95%
- [ ] å‰ç«¯bundleå¤§å°å¢åŠ  < 50KB

### 11.3 è´¨é‡éªŒæ”¶

- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 70%
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ— ä¸¥é‡bugï¼ˆP0/P1ï¼‰
- [ ] ä»£ç reviewé€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´

---

## ğŸ“Š é™„å½•

### é™„å½•A: æŠ€æœ¯æ ˆæ¸…å•

**å‰ç«¯**:
- Vue 3 + Composition API
- TypeScript
- Nuxt 3
- Tailwind CSS
- @vueuse/core (å·¥å…·åº“)
- lucide-vue-next (å›¾æ ‡)

**åç«¯**:
- Python 3.12+
- FastAPI
- SQLAlchemy
- OpenAI Python SDK
- Pydantic (æ•°æ®éªŒè¯)
- Tenacity (é‡è¯•æœºåˆ¶)

**æ•°æ®åº“**:
- SQLite (å¼€å‘ç¯å¢ƒ)
- PostgreSQL (ç”Ÿäº§ç¯å¢ƒæ¨è)

**åŸºç¡€è®¾æ–½**:
- Docker (å®¹å™¨åŒ–)
- Redis (ç¼“å­˜ - å¯é€‰)
- Sentry (é”™è¯¯ç›‘æ§ - å¯é€‰)

### é™„å½•B: å‚è€ƒèµ„æ–™

- [OpenAI API Documentation](https://platform.openai.com/docs)
- [Prompt Engineering Guide](https://www.promptingguide.ai/)
- [Vue 3 Composition API](https://vuejs.org/guide/extras/composition-api-faq.html)
- [Tailwind CSS](https://tailwindcss.com/docs)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2025-10-20
**ç»´æŠ¤è€…**: InsightReader Team
**å®¡æ ¸çŠ¶æ€**: âœ… å·²å®¡æ ¸

---

## å˜æ›´æ—¥å¿—

### v1.0.0 - 2025-10-20
- åˆå§‹ç‰ˆæœ¬
- å®Œæˆå®Œæ•´çš„æŠ€æœ¯è®¾è®¡
- åŒ…å«æ•°æ®åº“è®¾è®¡ã€APIè®¾è®¡ã€UI/UXè®¾è®¡
- åŒ…å«LLM Promptå·¥ç¨‹æ–¹æ¡ˆ
- åŒ…å«å®æ–½è·¯çº¿å›¾å’Œé£é™©è¯„ä¼°
